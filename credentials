import trino
import pandas as pd
try:
    # Set up Trino connection details
    conn = trino.dbapi.connect(
        host='172.23.56.100',
        port=8445,
        user='23127803',
        catalog='hive',
        schema='canvas',
        http_scheme='https',
        auth=trino.auth.BasicAuthentication("23127803", "Standups#23!"),
        verify=r"D:\jks\presto.com_cert_0.pem"
    )
    print("✅ Connected to Trino database successfully!")
 
    # Your query
    query = """
        select * from hive.canvas.subscriberdimension where indeactivationtime is null and date(recactivationtime) =date'2025-12-07'
    """
 
    # Run query
    cursor = conn.cursor()
    cursor.execute(query)
    rows = cursor.fetchall()
    # Display output
    # for row in rows:
    #     print(row)
    columns = [col[0] for col in cursor.description]
    # Convert to DataFrame
    df = pd.DataFrame(rows,columns=columns)
except Exception as e:
    print(f"❌ Error occurred: {e}")
cursor.close()



iceberg.adhoc.ufaa_23203159
